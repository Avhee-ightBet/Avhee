package studentinfosystem;

import java.util.HashMap;
import java.util.Scanner;

public class StudentInfoSystem {

    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);
        HashMap<String, Student> studentRecords = new HashMap<>();

        while (true) {
            System.out.println("\nSTUDENT INFORMATION SYSTEM");
            System.out.println("1  Add Student");
            System.out.println("2  Search Student");
            System.out.println("3  Update Student");
            System.out.println("4  Remove Student");
            System.out.println("5  View All Students");
            System.out.println("6  Exit");
            System.out.print("Choose option: ");
            int option = sc.nextInt();
            sc.nextLine();

            switch (option) {
                // ADD STUDENT
                case 1:
                    System.out.print("Enter Name: ");
                    String name = sc.nextLine();
                    System.out.print("Enter Student ID: ");
                    String studentId = sc.nextLine();
                    System.out.print("Enter Gender: ");
                    String gender = sc.nextLine();
                    System.out.print("Enter Age: ");
                    int age = sc.nextInt();
                    sc.nextLine();

                    String contact;
                    while (true) {
                        System.out.print("Enter Contact Number: ");
                        contact = sc.nextLine().trim();
                        if (contact.matches("\\d{11}")) {
                            break;
                        } else {
                            System.out.println("Invalid contact number.");
                        }
                    }

                    String email;
                    while (true) {
                        System.out.print("Enter Email: ");
                        email = sc.nextLine().trim();
                        if (email.contains("@")) {
                            break;
                        } else {
                            System.out.println("Invalid email.");
                        }
                    }

                    int yearLevel;
                    while (true) {
                        System.out.print("Enter Year Level: ");
                        yearLevel = sc.nextInt();
                        sc.nextLine();
                        if (yearLevel >= 1 && yearLevel <= 4) {
                            break;
                        } else {
                            System.out.println("Invalid year level.");
                        }
                    }

                    String course;
                    while (true) {
                        System.out.print("Enter Course: ");
                        course = sc.nextLine().trim().toUpperCase();
                        if (course.equals("BSIT") || course.equals("BSHM") || course.equals("BSTM") || course.equals("BSCPE")) {
                            break;
                        } else {
                            System.out.println("Invalid course. (BSIT, BSHM, BSTM, BSCPE)");
                        }
                    }
                    String emNumber;
                    while (true) {
                        System.out.print("Enter Emergency Contact Number: ");
                        emNumber = sc.nextLine().trim();
                        if (emNumber.matches("\\d{11}")) {
                            break;
                        } else {
                            System.out.println("Invalid number.");
                        }
                    }

                    System.out.print("Enter Emergency Contact Name: ");
                    String emContact = sc.nextLine();
                    System.out.print("Enter Relationship with Emergency Contact: ");
                    String emRelation = sc.nextLine();

                    Student student = new Student(name, studentId, gender, age, contact, email,
                            yearLevel, course, emContact, emRelation, emNumber);
                    studentRecords.put(name, student);
                    System.out.println("   --Student added--");
                    break;

                // SEARCH STUDENT
                case 2:
                    if (studentRecords.isEmpty()) {
                        System.out.println("No student available.");
                        break;
                    }

                    System.out.println("\nSEARCH STUDENT");
                    System.out.println("1 - Name");
                    System.out.println("2 - Student ID");
                    System.out.println("3 - Gender");
                    System.out.println("4 - Age");
                    System.out.println("5 - Contact Number");
                    System.out.println("6 - Email");
                    System.out.println("7 - Year Level");
                    System.out.println("8 - Course");
                    System.out.print("Choose search method: ");
                    int searchOption = sc.nextInt();
                    sc.nextLine();

                    String strSearch = "";
                    int intSearch = 0;

                    switch (searchOption) {
                        case 1:
                            System.out.print("Enter Name: ");
                            strSearch = sc.nextLine();
                            break;
                        case 2:
                            System.out.print("Enter Student ID: ");
                            strSearch = sc.nextLine();
                            break;
                        case 3:
                            System.out.print("Enter Gender: ");
                            strSearch = sc.nextLine();
                            break;
                        case 4:
                            System.out.print("Enter Age: ");
                            intSearch = sc.nextInt();
                            sc.nextLine();
                            break;
                        case 5:
                            System.out.print("Enter Contact Number: ");
                            strSearch = sc.nextLine();
                            break;
                        case 6:
                            System.out.print("Enter Email: ");
                            strSearch = sc.nextLine();
                            break;
                        case 7:
                            System.out.print("Enter Year Level: ");
                            intSearch = sc.nextInt();
                            sc.nextLine();
                            break;
                        case 8:
                            System.out.print("Enter Course: ");
                            strSearch = sc.nextLine();
                            break;
                        default:
                            System.out.println("Invalid search option.");
                            continue;
                    }

                    boolean anyFound = false;

                    System.out.printf("%-15s %-10s %-8s %-5s %-15s %-20s %-10s %-15s %-20s %-15s %-15s%n",
                            "Name", "ID", "Gender", "Age", "Contact", "Email", "Year", "Course",
                            "Emergency Contact", "Relation", "Emergency Number");
                    System.out.println("-------------------------------------------------------------------------------------------------------------------");

                    for (Student s : studentRecords.values()) {
                        boolean match = false;
                        switch (searchOption) {
                            case 1:
                                if (s.getName().equalsIgnoreCase(strSearch)) {
                                    match = true;
                                }
                                break;
                            case 2:
                                if (s.getStudentId().equalsIgnoreCase(strSearch)) {
                                    match = true;
                                }
                                break;
                            case 3:
                                if (s.getGender().equalsIgnoreCase(strSearch)) {
                                    match = true;
                                }
                                break;
                            case 4:
                                if (s.getAge() == intSearch) {
                                    match = true;
                                }
                                break;
                            case 5:
                                if (s.getContactNumber().equals(strSearch)) {
                                    match = true;
                                }
                                break;
                            case 6:
                                if (s.getEmail().equalsIgnoreCase(strSearch)) {
                                    match = true;
                                }
                                break;
                            case 7:
                                if (s.getYearLevel() == intSearch) {
                                    match = true;
                                }
                                break;
                            case 8:
                                if (s.getCourse().equalsIgnoreCase(strSearch)) {
                                    match = true;
                                }
                                break;
                        }
                        if (match) {
                            System.out.printf("%-15s %-10s %-8s %-5d %-15s %-20s %-10d %-15s %-20s %-15s %-15s%n",
                                    s.getName(), s.getStudentId(), s.getGender(), s.getAge(),
                                    s.getContactNumber(), s.getEmail(), s.getYearLevel(), s.getCourse(),
                                    s.getEmergencyContact(), s.getEmergencyRelation(), s.getEmergencyNumber());
                            anyFound = true;
                        }
                    }
                    if (!anyFound) {
                        System.out.println("No student available.");
                    }
                    break;

                // UPDATE STUDENT
                case 3:
                    System.out.print("Enter name to update: ");
                    String updateName = sc.nextLine();
                    if (studentRecords.containsKey(updateName)) {
                        System.out.println("Enter new details:");

                        System.out.print("Enter Name: ");
                        String updName = sc.nextLine();
                        System.out.print("Enter Student ID: ");
                        String updId = sc.nextLine();
                        System.out.print("Enter Gender: ");
                        String updGender = sc.nextLine();
                        System.out.print("Enter Age: ");
                        int updAge = sc.nextInt();
                        sc.nextLine();

                        String updContact;
                        while (true) {
                            System.out.print("Enter Contact Number: ");
                            updContact = sc.nextLine().trim();
                            if (updContact.matches("\\d{11}")) {
                                break;
                            } else {
                                System.out.println("Invalid contact number.");
                            }
                        }

                        String updEmail;
                        while (true) {
                            System.out.print("Enter Email: ");
                            updEmail = sc.nextLine().trim();
                            if (updEmail.contains("@")) {
                                break;
                            } else {
                                System.out.println("Invalid email.");
                            }
                        }

                        int updYear;
                        while (true) {
                            System.out.print("Enter Year Level (1, 2, 3, 4): ");
                            updYear = sc.nextInt();
                            sc.nextLine();
                            if (updYear >= 1 && updYear <= 4) {
                                break;
                            } else {
                                System.out.println("Invalid year level.");
                            }
                        }

                        String updCourse;
                        while (true) {
                            System.out.print("Enter Course (BSIT, BSHM, BSTM, BSCPE): ");
                            updCourse = sc.nextLine().trim().toUpperCase();
                            if (updCourse.equals("BSIT") || updCourse.equals("BSHM") || updCourse.equals("BSTM") || updCourse.equals("BSCPE")) {
                                break;
                            } else {
                                System.out.println("Invalid course. (BSIT, BSHM, BSTM, BSCPE)");
                            }
                        }
                        String updEmNumber;
                        while (true) {
                            System.out.print("Enter Emergency Contact Number: ");
                            updEmNumber = sc.nextLine().trim();
                            if (updEmNumber.matches("\\d{11}")) {
                                break;
                            } else {
                                System.out.println("Invalid number.");
                            }
                        }
                        System.out.print("Enter Emergency Contact Name: ");
                        String updEmContact = sc.nextLine();
                        System.out.print("Enter Relationship with Emergency Contact: ");
                        String updEmRelation = sc.nextLine();

                        Student updatedStudent = new Student(updName, updId, updGender, updAge,
                                updContact, updEmail, updYear, updCourse, updEmContact, updEmRelation, updEmNumber);

                        studentRecords.remove(updateName);
                        studentRecords.put(updName, updatedStudent);
                        System.out.println("Student updated.");
                    } else {
                        System.out.println("Student not found.");
                    }
                    break;

                // REMOVE STUDENT
                case 4:
                    System.out.print("Enter name to remove: ");
                    String removeName = sc.nextLine();
                    if (studentRecords.containsKey(removeName)) {
                        studentRecords.remove(removeName);
                        System.out.println("Student removed.");
                    } else {
                        System.out.println("Student not found.");
                    }
                    break;

                // VIEW ALL
                case 5:
                    if (studentRecords.isEmpty()) {
                        System.out.println("No records found.");
                        break;
                    }
                    System.out.printf("%-15s %-10s %-8s %-5s %-15s %-20s %-10s %-15s %-20s %-15s %-15s%n",
                            "Name", "ID", "Gender", "Age", "Contact", "Email", "Year", "Course",
                            "Emergency Contact", "Relation", "Emergency Number");
                    System.out.println("-------------------------------------------------------------------------------------------------------------------");
                    for (Student s : studentRecords.values()) {
                        System.out.printf("%-15s %-10s %-8s %-5d %-15s %-20s %-10d %-15s %-20s %-15s %-15s%n",
                                s.getName(), s.getStudentId(), s.getGender(), s.getAge(),
                                s.getContactNumber(), s.getEmail(), s.getYearLevel(), s.getCourse(),
                                s.getEmergencyContact(), s.getEmergencyRelation(), s.getEmergencyNumber());
                    }
                    break;

                // EXIT
                case 6:
                    System.out.println("System closed.");
                    System.exit(0);
                    break;

                default:
                    System.out.println("Invalid option.");
            }
        }
    }
}

